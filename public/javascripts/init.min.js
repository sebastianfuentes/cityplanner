var map,uk={lat:51.5224821,lng:-.1389824},markers=[],markersSelected=[],position,bounds,infowindow,service,text='<i class="material-icons">&#xE55C;</i>';function CenterControl(a,b,e){b=document.createElement("div");b=document.createElement("div");b.title="Center to your location";a.appendChild(b);b.className="location-outside";a=document.createElement("div");a.innerHTML=e;b.appendChild(a);a.className="location-inside";google.maps.event.addDomListener(b,"click",function(){geoLocation()})}function initialize(a){a=document.getElementById("search");map=new google.maps.Map(document.getElementById("map"),{center:uk,zoom:16,disableDefaultUI:!0,zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.RIGHT_CENTER}});infowindow=new google.maps.InfoWindow;service=new google.maps.places.PlacesService(map);geoLocation();a=document.createElement("div");a.className="control";map.controls[google.maps.ControlPosition.TOP_RIGHT].push(a);new CenterControl(a,map,text);a=document.getElementById("searchbar");var b=new google.maps.places.SearchBox(a);map.controls[google.maps.ControlPosition.TOP_LEFT].push(a);map.addListener("bounds_changed",function(){b.setBounds(map.getBounds());changeRange()});google.maps.event.addListenerOnce(map,"idle",function(){changeRange()});b.addListener("places_changed",function(){var a=b.getPlaces();0!=a.length&&(clearMap(),a.forEach(function(a){a=new google.maps.LatLng(a.geometry.location.lat(),a.geometry.location.lng());loadNearby(a);map.panTo(a);map.setZoom(14)}))})}function geoLocation(){new google.maps.Size(32,32);new google.maps.Point(0,0);new google.maps.Point(16,32);navigator.geolocation?navigator.geolocation.getCurrentPosition(function(a){a=new google.maps.LatLng(a.coords.latitude,a.coords.longitude);map.panTo(a);map.setZoom(14);0==markers.length&&loadNearby(a)},function(){handleNoGeolocation(!0)}):handleNoGeolocation(!1)}function clearMap(){if(0!=markers.length){for(var a=0,b;b=markers[a];a++)b.setMap(null);markers=[]}}function handleNoGeolocation(a){map.setCenter(uk)}function loadNearby(a){service.nearbySearch({location:a,radius:7E3,types:["museum"]},callback)}function callback(a,b){if(b===google.maps.places.PlacesServiceStatus.OK)for(var e=0;e<a.length;e++)createMarker(a[e])}function createMarker(a){var b={url:"../images/marker.svg",scaledSize:new google.maps.Size(32,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,32)},b=new google.maps.Marker({map:map,position:a.geometry.location,animation:google.maps.Animation.DROP,time:randomNum(1,9),title:a.name,id:a.id,checked:!1,selected:!1,icon:b});markers.push(b);google.maps.event.addListener(b,"click",function(){content=void 0==a.opening_hours?"<div><b>"+a.name+"</b></div>":void 0!=a.opening_hours&&1==a.opening_hours.open_now?"<div><b>"+a.name+"</b></div> Open now":"<div><b>"+a.name+"</b></div> Closed now";infowindow.setContent(content);infowindow.open(map,this)});google.maps.event.addListener(b,"dblclick",function(){})}function randomNum(a,b){return Math.floor(Math.random()*(b-a))+a}function changeRange(){var a=document.getElementById("range").value;document.getElementById("inner-hours").innerHTML=a+" hours";filterMarkers(a)}function filterMarkers(a){$(".pick-container").empty();for(var b=0;b<markers.length;b++)markers[b].time>a?markers[b].setVisible(!1):(fillChecklist(markers[b],b),markers[b].setVisible(!0))}function fillChecklist(a,b){var e;e=a.checked?"<div onclick='checkCheckbox(this)' class='option container-"+b+"'><input onchange='addThisToList(this,event)' checked type='checkbox' id='"+a.id+"' value='"+a.time+"'><span class='title'>"+a.title+"</span><span class='time'>Estimated time: "+a.time+"</span></div>":"<div onclick='checkCheckbox(this)' class='option container-"+b+"'><input onchange='addThisToList(this,event)' type='checkbox' id='"+a.id+"' value='"+a.time+"'><span class='title'>"+a.title+"</span><span class='time'>Estimated time: "+a.time+"</span></div>";$(".pick-container").append(e)}function addThisToList(a,b){var e,c={url:"../images/marker-blue.svg",scaledSize:new google.maps.Size(32,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,32)},f={url:"../images/marker.svg",scaledSize:new google.maps.Size(32,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,32)};e=b.target.id;if(b.srcElement.checked)for(var d=0;d<markers.length;d++)if(e==markers[d].id){markers[d].checked=!0;markers[d].setIcon(c);markers[d].selected=!0;markersSelected.push(markers[d]);map.panTo(markers[d].position);google.maps.event.trigger(markers[d],"click");break}else markers[d].selected?markers[d].setIcon(c):markers[d].setIcon(f);else for(d=0;d<markers.length;d++)e==markers[d].id&&(markers[d].checked=!1,markers[d].setIcon(f),markersSelected.splice(d,1))}function addThisToListFromMap(a){var b={url:"../images/marker-blue.svg",scaledSize:new google.maps.Size(32,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,32)},e={url:"../images/marker.svg",scaledSize:new google.maps.Size(32,32),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(16,32)};if(a.checked)for(c=0;c<markers.length;c++)a.id==markers[c].id&&(document.getElementById(a.id).removeAttribute("checked"),markers[c].checked=!1,markers[c].setIcon(e),markersSelected.splice(c,1));else for(var c=0;c<markers.length;c++)if(a.id==markers[c].id){markers[c].checked=!0;markers[c].setIcon(b);markers[c].selected=!0;markersSelected.push(markers[c]);map.panTo(markers[c].position);google.maps.event.trigger(markers[c],"click");document.getElementById(a.id).setAttribute("checked","checked");break}else markers[c].selected?markers[c].setIcon(b):markers[c].setIcon(e)}function checkCheckbox(a){}google.maps.event.addDomListener(window,"load",initialize);